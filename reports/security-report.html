<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OpenClaw Security Hooks - Test Report</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace; background: #0a0a0a; color: #e0e0e0; padding: 2rem; line-height: 1.6; }
  .container { max-width: 1000px; margin: 0 auto; }
  
  h1 { font-size: 1.8rem; color: #00ff88; margin-bottom: 0.3rem; letter-spacing: -0.5px; }
  .subtitle { color: #666; font-size: 0.9rem; margin-bottom: 2rem; }
  .date { color: #444; font-size: 0.8rem; }
  
  .hero { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2.5rem; }
  .stat { background: #111; border: 1px solid #222; border-radius: 8px; padding: 1.2rem; text-align: center; }
  .stat-value { font-size: 2.2rem; font-weight: bold; color: #00ff88; }
  .stat-value.warning { color: #ffaa00; }
  .stat-value.danger { color: #ff4444; }
  .stat-label { font-size: 0.75rem; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-top: 0.3rem; }
  
  h2 { font-size: 1.2rem; color: #00ff88; margin: 2rem 0 1rem; border-bottom: 1px solid #222; padding-bottom: 0.5rem; }
  
  .category-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
  .category-card { background: #111; border: 1px solid #222; border-radius: 8px; padding: 1rem; position: relative; overflow: hidden; }
  .category-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: #00ff88; }
  .category-name { font-size: 0.9rem; font-weight: bold; color: #ccc; margin-bottom: 0.5rem; text-transform: capitalize; }
  .category-bar { background: #1a1a1a; border-radius: 4px; height: 8px; margin: 0.5rem 0; overflow: hidden; }
  .category-fill { height: 100%; background: linear-gradient(90deg, #00ff88, #00cc66); border-radius: 4px; transition: width 0.5s; }
  .category-stats { display: flex; justify-content: space-between; font-size: 0.75rem; color: #666; }
  
  .architecture { background: #111; border: 1px solid #222; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
  .arch-flow { display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap; font-size: 0.85rem; padding: 1rem 0; }
  .arch-box { background: #1a1a1a; border: 1px solid #333; border-radius: 6px; padding: 0.5rem 1rem; color: #ccc; }
  .arch-box.hook { border-color: #00ff88; color: #00ff88; background: #0a1a0f; }
  .arch-arrow { color: #444; font-size: 1.2rem; }
  
  .attack-table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
  .attack-table th { text-align: left; padding: 0.7rem; border-bottom: 2px solid #222; color: #888; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; }
  .attack-table td { padding: 0.7rem; border-bottom: 1px solid #1a1a1a; font-size: 0.85rem; }
  .attack-table tr:hover { background: #111; }
  .badge { display: inline-block; padding: 0.15rem 0.5rem; border-radius: 3px; font-size: 0.7rem; font-weight: bold; }
  .badge.pass { background: #0a2a0f; color: #00ff88; border: 1px solid #00ff8844; }
  .badge.fail { background: #2a0a0a; color: #ff4444; border: 1px solid #ff444444; }
  
  .footer { margin-top: 3rem; padding-top: 1rem; border-top: 1px solid #1a1a1a; color: #333; font-size: 0.75rem; text-align: center; }
  
  .test-suites { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1rem 0; }
  .suite { background: #111; border: 1px solid #222; border-radius: 8px; padding: 1rem; text-align: center; }
  .suite-name { font-size: 0.8rem; color: #888; margin-bottom: 0.3rem; }
  .suite-result { font-size: 1.4rem; font-weight: bold; color: #00ff88; }
  .suite-detail { font-size: 0.7rem; color: #555; margin-top: 0.2rem; }
</style>
</head>
<body>
<div class="container">
  <h1>OpenClaw Security Hooks</h1>
  <div class="subtitle">Deterministic Enforcement Test Report</div>
  <div class="date">Generated: 2026-02-20 | Framework: OpenClaw | Agent: ClawdBot</div>
  
  <div class="hero">
    <div class="stat">
      <div class="stat-value">251</div>
      <div class="stat-label">Total Tests</div>
    </div>
    <div class="stat">
      <div class="stat-value">251</div>
      <div class="stat-label">Passed</div>
    </div>
    <div class="stat">
      <div class="stat-value">0</div>
      <div class="stat-label">Failed</div>
    </div>
    <div class="stat">
      <div class="stat-value">100%</div>
      <div class="stat-label">Block Rate</div>
    </div>
  </div>
  
  <div class="test-suites">
    <div class="suite">
      <div class="suite-name">Attack Pattern Suite</div>
      <div class="suite-result">90/90</div>
      <div class="suite-detail">All categories passing</div>
    </div>
    <div class="suite">
      <div class="suite-name">Red Team Pipeline</div>
      <div class="suite-result">118/118</div>
      <div class="suite-detail">Variant generation + encoding</div>
    </div>
    <div class="suite">
      <div class="suite-name">HookManager Unit</div>
      <div class="suite-result">43/43</div>
      <div class="suite-detail">Patterns, execution, security</div>
    </div>
  </div>

  <h2>Architecture</h2>
  <div class="architecture">
    <div class="arch-flow">
      <div class="arch-box">Agent (LLM)</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box">Tool Call</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box hook">BEFORE HOOKS</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box">Gateway</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box">External API</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box hook">AFTER HOOKS</div>
      <div class="arch-arrow">&#8594;</div>
      <div class="arch-box">Response</div>
    </div>
    <div style="text-align:center; color:#555; font-size:0.75rem; margin-top:0.5rem;">
      Before hooks validate/transform parameters. After hooks sanitize responses. Both run in code, not in system prompts.
    </div>
  </div>

  <h2>Coverage by Category</h2>
  <div class="category-grid">
    <div class="category-card">
      <div class="category-name">System Override</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>45 variants tested</span><span style="color:#00ff88">100% blocked</span></div>
    </div>
    <div class="category-card">
      <div class="category-name">Data Exfiltration</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>30 variants tested</span><span style="color:#00ff88">100% blocked</span></div>
    </div>
    <div class="category-card">
      <div class="category-name">Roleplay Injection</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>25 variants tested</span><span style="color:#00ff88">100% blocked</span></div>
    </div>
    <div class="category-card">
      <div class="category-name">Encoding Attacks</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>8 variants (B64/URL/hex)</span><span style="color:#00ff88">100% blocked</span></div>
    </div>
    <div class="category-card">
      <div class="category-name">Context Manipulation</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>5 variants tested</span><span style="color:#00ff88">100% blocked</span></div>
    </div>
    <div class="category-card">
      <div class="category-name">Legitimate Content</div>
      <div class="category-bar"><div class="category-fill" style="width:100%"></div></div>
      <div class="category-stats"><span>5 false positive checks</span><span style="color:#00ff88">0 false positives</span></div>
    </div>
  </div>

  <h2>Attack Pattern Details</h2>
  <table class="attack-table">
    <thead>
      <tr><th>Category</th><th>Attack Type</th><th>Detection Method</th><th>Status</th></tr>
    </thead>
    <tbody>
      <tr><td>Prompt Injection</td><td>System overrides ("ignore previous instructions")</td><td>Pattern matching + case variants</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Prompt Injection</td><td>Roleplay ("you are now a hacker")</td><td>Keyword detection + sentence removal</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Prompt Injection</td><td>Instruction injection (fake separators)</td><td>Conversation separator detection</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Encoding</td><td>Single/double/triple Base64</td><td>Recursive decode + keyword check</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Encoding</td><td>URL encoding (%XX chains)</td><td>URL decode + re-check</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Encoding</td><td>Hex encoding (\x41 patterns)</td><td>Hex decode + keyword check</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Exfiltration</td><td>System prompt extraction</td><td>30+ pattern matching</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Exfiltration</td><td>Config/API key access</td><td>File path + env var detection</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Context</td><td>Fake tokens (&lt;|im_end|&gt;, &lt;|endoftext|&gt;)</td><td>Token pattern stripping</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Context</td><td>JSON role injection</td><td>JSON structure detection</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Context</td><td>HTML comment injection</td><td>Comment pattern + keyword check</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Unicode</td><td>Cyrillic homoglyph evasion</td><td>Normalization + post-check</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Format</td><td>Non-Block Kit payloads</td><td>Structure validation</td><td><span class="badge pass">BLOCKED</span></td></tr>
      <tr><td>Format</td><td>Em dashes, bare markdown</td><td>Unicode + pattern detection</td><td><span class="badge pass">BLOCKED</span></td></tr>
    </tbody>
  </table>

  <h2>Key Insight</h2>
  <div class="architecture">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:2rem;">
      <div>
        <div style="color:#ff4444; font-weight:bold; margin-bottom:0.5rem;">System Prompts (Probabilistic)</div>
        <ul style="list-style:none; font-size:0.85rem; color:#888;">
          <li>Can be ignored by the model</li>
          <li>Inconsistent across contexts</li>
          <li>Natural language ambiguity</li>
          <li>No audit trail</li>
          <li>Bypassable via prompt injection</li>
        </ul>
      </div>
      <div>
        <div style="color:#00ff88; font-weight:bold; margin-bottom:0.5rem;">Hook System (Deterministic)</div>
        <ul style="list-style:none; font-size:0.85rem; color:#888;">
          <li>Cannot be bypassed by model output</li>
          <li>Consistent enforcement always</li>
          <li>Code-based precision</li>
          <li>Full audit logging</li>
          <li>Immune to prompt injection</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="footer">
    Built in one day. 1,917 lines of code. 251 tests. Zero bypasses.<br>
    OpenClaw Security Hooks - github.com/PHMD/openclaw-security-hooks
  </div>
</div>
</body>
</html>
